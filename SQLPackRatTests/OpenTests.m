//
//  OpenTests.m
//  SQLPackRat
//
//  Created by Steven Fisher on 2015-05-20.
//  Copyright (c) 2015 Steven Fisher. All rights reserved.
//

#import <UIKit/UIKit.h>
#import <XCTest/XCTest.h>

#import "SQLPackRat.h"


@interface OpenTests : XCTestCase

@end

@implementation OpenTests


- (void)testExample {
    NSError *e;
    NSString *baseDirectory = [NSSearchPathForDirectoriesInDomains(NSLibraryDirectory, NSUserDomainMask, YES)[0] stringByAppendingPathComponent:@"net.tewha.sqlpackrat.tests"];
    
    [[NSFileManager defaultManager] createDirectoryAtPath:baseDirectory withIntermediateDirectories:YES attributes:nil error:&e];
    
    NSString *invalidPath = [[baseDirectory stringByAppendingPathComponent:@"invalid"]stringByAppendingPathComponent:@"test.db"];
    XCTAssertNil([[SQLPRDatabase alloc] initWithPath:invalidPath flags:(SQLITE_OPEN_READWRITE | SQLITE_OPEN_CREATE) VFS:nil error:&e], @"Database unexpectedly returned for invalid path.");
    
    NSString *validPath = [baseDirectory stringByAppendingPathComponent:@"test.db"];
    SQLPRDatabase *database = [[SQLPRDatabase alloc] initWithPath:validPath flags:(SQLITE_OPEN_READWRITE | SQLITE_OPEN_CREATE) VFS:nil error:&e];
    XCTAssertNotNil(database, @"No database returned.");
}


@end
